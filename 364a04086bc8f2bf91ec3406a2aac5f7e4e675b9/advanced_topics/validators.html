<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Validators - Linera Developer Documentation</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../custom.css">

    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../overview.html"><strong aria-hidden="true">2.</strong> Overview</a></li><li class="chapter-item expanded "><a href="../getting_started.html"><strong aria-hidden="true">3.</strong> Getting started</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../getting_started/installation.html"><strong aria-hidden="true">3.1.</strong> Installation</a></li><li class="chapter-item expanded "><a href="../getting_started/first_app.html"><strong aria-hidden="true">3.2.</strong> Your First App</a></li></ol></li><li class="chapter-item expanded "><a href="../core_concepts.html"><strong aria-hidden="true">4.</strong> Core Concepts</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../core_concepts/micro_chains.html"><strong aria-hidden="true">4.1.</strong> Microchains</a></li><li class="chapter-item expanded "><a href="../core_concepts/wallet.html"><strong aria-hidden="true">4.2.</strong> The Wallet</a></li><li class="chapter-item expanded "><a href="../core_concepts/applications.html"><strong aria-hidden="true">4.3.</strong> Applications</a></li><li class="chapter-item expanded "><a href="../core_concepts/sdk.html"><strong aria-hidden="true">4.4.</strong> Linera SDK</a></li><li class="chapter-item expanded "><a href="../core_concepts/testing.html"><strong aria-hidden="true">4.5.</strong> Testing</a></li></ol></li><li class="chapter-item expanded "><a href="../advanced.html"><strong aria-hidden="true">5.</strong> Advanced Topics</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../advanced_topics/views.html"><strong aria-hidden="true">5.1.</strong> Views</a></li><li class="chapter-item expanded "><a href="../advanced_topics/validators.html" class="active"><strong aria-hidden="true">5.2.</strong> Validators</a></li><li class="chapter-item expanded "><a href="../advanced_topics/block_creation.html"><strong aria-hidden="true">5.3.</strong> Creating New Blocks</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Linera Developer Documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="validators"><a class="header" href="#validators">Validators</a></h1>
<p>The validators run servers that allow users to download and create blocks. They validate,
execute and cryptographically certify blocks on all microchains. That means every single
chain is backed by the full set of validators, and has the same level of security.</p>
<p>Concretely, they guarantee that:</p>
<ul>
<li>Each block is valid, i.e. it has the correct format, its operations are allowed, the
received effects are in the correct order, and e.g. the balance was correctly computed.</li>
<li>Every effect received by one chain was actually sent by another chain.</li>
<li>If one block on a particular height is certified, no other block on the same height is.</li>
</ul>
<p>To undermine these guarantees, at least one third of the validators (weighted by their
stake) would need to cheat---in a detectable way! (Staking is not yet implemented, but in
the future, malicious validators would forfeit their stakes.)</p>
<p>Since validators do not propose blocks on most chains, they do <em>not</em> guarantee that any
particular operation or effect will eventually be executed on a chain. Instead, chain
owners decide whether and when to propose new blocks, and which operations and effects to
include.
The Linera client implementation will automatically include all incoming effects in new
blocks. The operations are the actions the chain owner explicitly adds, e.g. transfer.</p>
<h2 id="scalability"><a class="header" href="#scalability">Scalability</a></h2>
<p>Since every chain uses the same validators, adding more chains does not require adding
additional validators. Instead, it requires each individual validator to scale up and
handle the additional load.</p>
<p>That is why Linera allows the same validator to run multiple <code>server</code>
processes—<em>workers</em>—on different machines, each one processing a different subset of
the microchains. The workers communicate directly with each other whenever a chain sends
an effect to another chain.</p>
<h2 id="anatomy-of-a-validator"><a class="header" href="#anatomy-of-a-validator">Anatomy of a Validator</a></h2>
<p>To achieve scalability, Linera validators need to be horizontally scalable (sometimes
referred to as 'elastic'). To achieve this scalability, the architecture of a validator
involves splitting the chains up over multiple 'shards' or 'workers' which are
encapsulated by a single ingress/egress called the 'proxy'.</p>
<p>The validator has an internal network enabling the proxy to speak with shards and shards
with each other. Each shard is also backed by its own data store which can be scaled
independently of the rest of the validator</p>
<pre><code class="language-ignore"> example network
                     │                                           │
                     │                                           │
                     │                                           │
┌────────────────────┼────────────────────┐ ┌────────────────────┼────────────────────┐
│ validator 1        │                    │ │ validator 2        │                    │
│              ┌─────┴─────┐              │ │              ┌─────┴─────┐              │
│              │   proxy   │              │ │              │   proxy   │              │
│        ┌─────┤           ├─────┐        │ │        ┌─────┤           ├─────┐        │
│        │     └───────────┘     │        │ │        │     └───────────┘     │        │
│        │                       │        │ │        │                       │        │
│        │                       │        │ │        │                       │        │
│  ┌─────┴─────┐           ┌─────┴─────┐  │ │  ┌─────┴─────┐           ┌─────┴─────┐  │
│  │   shard   │           │   shard   │  │ │  │   shard   │           │   shard   │  │
│  │     1     │           │     2     │  │ │  │     1     │           │     2     │  │
│  └─────┬─────┘           └─────┬─────┘  │ │  └─────┬─────┘           └─────┬─────┘  │
│        │                       │        │ │        │                       │        │
│  ┌─────┴─────┐           ┌─────┴─────┐  │ │  ┌─────┴─────┐           ┌─────┴─────┐  │
│  │    db1    │           │    db2    │  │ │  │    db1    │           │    db2    │  │
│  │           │           │           │  │ │  │           │           │           │  │
│  └───────────┘           └───────────┘  │ │  └───────────┘           └───────────┘  │
│                                         │ │                                         │
└─────────────────────────────────────────┘ └─────────────────────────────────────────┘

</code></pre>
<h2 id="configuring-networks-workers-and-proxies"><a class="header" href="#configuring-networks-workers-and-proxies">Configuring Networks, Workers and Proxies</a></h2>
<p>In <a href="../getting_started/first_app.html">Your First App</a> we used the <code>run_local.sh</code> script
to start a local network. This should be sufficient for most use cases when you're running
a local network.</p>
<pre><code class="language-bash">./scripts/run_local.sh
</code></pre>
<p>However, it is possible to customize and configure the parameters of the network.</p>
<p><code>run_local.sh</code> uses the <code>validator_n.toml</code> file from the <code>configuration/</code> directory to configure validator number <code>n</code>.</p>
<pre><code class="language-bash">./server generate --validators configuration/validator_{1,2,3,4}.toml --committee committee.json
</code></pre>
<p>generates keys and writes them, together with the options from the TOML files, to
<code>server_1.json</code>, ..., <code>server_4.json</code>. It also stores the set of the new validators'
public keys in <code>committee.json</code>.</p>
<pre><code class="language-bash">./linera --wallet wallet.json create-genesis-config 10 --genesis genesis.json --initial-funding 10 --committee committee.json
</code></pre>
<p>creates a configuration for the initial state of the network, <code>genesis.json</code>, with 10
chains, each with a balance of 10. It also creates a <code>wallet.json</code> for a client who owns
all those chains.</p>
<p>To start the newly configured network, each validator <code>n</code> must start their proxy:</p>
<pre><code class="language-bash">./proxy server_n.json &amp;
</code></pre>
<p>And all shards; for shard <code>i</code>:</p>
<pre><code class="language-bash">./server run --storage rocksdb:server_n_i.db --server server_n.json --shard i --genesis genesis.json &amp;
</code></pre>
<p>This will create a separate database file <code>server_n_i.db</code> for each shard. In a production
network, these would be running on different machines.</p>
<h2 id="changing-the-set-of-validators"><a class="header" href="#changing-the-set-of-validators">Changing the Set of Validators</a></h2>
<p>If a new validator wants to start participating, or an old one wants to leave, all chains
must be updated.</p>
<p>The system has has one designated <em>admin chain</em>, where the validators can join or leave
or, and where new <em>epochs</em> are defined. During every epoch, the set of validators is
fixed. If you own the admin chain, you can use the <code>set-validator</code> and <code>remove-validator</code>
commands to start a new epoch with a modified set of validators:</p>
<pre><code class="language-bash">./linera --wallet wallet.json set-validator --name 5b611b86cc1f54f73a4abfb4a2167c7327cc85a74cb2a5502431f67b554850b4 --address 127.0.0.1:9100 --votes 3
./linera --wallet wallet.json remove-validator --name f65a585f05852f0610e2460a99c23faa3969f3cfce8a519f843a793dbfb4cb84
</code></pre>
<p>Chain owners must then create a block that receives the <code>SetCommittees</code> effect from the
admin chain, and have it certified by the old validators. Only the <em>next</em> block in their
chain will be certified by the new validator set!</p>
<p>That is why epochs are planned to change infrequently—possibly once per day or per
week—, and several subsequent epochs can overlap, so that chain owners have plenty of
time to migrate their chains.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../advanced_topics/views.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../advanced_topics/block_creation.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../advanced_topics/views.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../advanced_topics/block_creation.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
